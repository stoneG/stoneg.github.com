<!DOCTYPE html>
<html lang="en">
<head>
        <title>writings - client</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
        <link href="http://blog.sitongpeng.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="writings Atom Feed" />
        <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700,400italic,700italic|Droid+Sans+Mono|Merriweather:400,300,700' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/theme/css/highlight.css">

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://blog.sitongpeng.com/css/ie.css"/>
                <script src="http://blog.sitongpeng.com/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://blog.sitongpeng.com/css/ie6.css"/><![endif]-->

</head>

<body>

    <header id="sidebar">
        <div class="bounds">
            <a href="https://twitter.com/stoneG_" target="_blank"><img class="face" src="https://raw.github.com/stoneG/stoneg.github.com/master/images/face.jpg"></a>
            <h1><a href="/">writings</a></h1>
            <p>they're the words that got out</p>
                <ul>
                    <li><a href="/index.html">Home</a></li>
                    <li><a href="http://www.sitongpeng.com/about.html">About</a></li>
                    <li><a href="/archives.html">Archives</a></li>
                    <li><a href="/tags.html">Tags</a></li>
                    <li><a href="/feeds/all.atom.xml">Atom</a></li>
                    <li></li>
                            <li><a href="http://twitter.com/stoneG_">Twitter</a></li>
                            <li><a href="https:/github.com/stoneG">Github</a></li>
                </ul>
        </div>
    </header>

    <section id="main">

        <header>
            <h1><a href="http://blog.sitongpeng.com/posts/on-generators-and-len.html" rel="bookmark"
                   title="Permalink to On generators and len">On generators and len</a></h1>
<p class="date">Wednesday, December 05, 2012</p>        </header>
        <article>
            <p>So one of the WSGI server specifications is that if a WSGI application
doesn’t supply the Content-Length response header, it is the job of the
WSGI server to try to determine the Content-Length of the response body
(if possible). This is straightforward enough for the average WSGI app,
which will return the response body in a list object. However, WSGI apps
also have the option of using a generator to return the response body
(since the specification only requires that the app return is an
iterable).</p>
<div class="section" id="so-can-we-apply-the-len-function-to-the-output-of-a-generator">
<h2>So can we apply the len function to the output of a generator?</h2>
</p><p>The answer is no. Generators are simple constructs that just yield
values when you iterate on them, immediately passing output along. And
since generators keep no memory of past generated values, they have no
idea what the length of their output is or will be. Therefore they don’t
have a len attribute.</p>
</div>
<div class="section" id="so-how-do-we-send-the-client-the-content-length-if-the-app-is-a-generator">
<h2>So how do we send the client the Content-Length if the app is a generator?</h2>
</p><p>Well, in HTTP/1.1, some servers and clients support the chunked transfer
coding. This allows servers to send response bodies in chunks, as they
are available. Each chunk will have it’s own Content-Length. I hope to
support chunked transferring in <a class="reference external" href="https://github.com/stoneG/whiskey">whiskey</a>, so I can always provide a
Content-Length. I’ll be sure to post about my implementation.</p>
</div>

    <p class="comments">
        <a href="http://blog.sitongpeng.com/posts/on-generators-and-len.html#disqus_thread"></a>.
    </p>
    <p class="tags">
            <a href="http://blog.sitongpeng.com/tag/whiskey.html">[whiskey]</a>
            <a href="http://blog.sitongpeng.com/tag/python.html">[python]</a>
            <a href="http://blog.sitongpeng.com/tag/http.html">[http]</a>
            <a href="http://blog.sitongpeng.com/tag/generators.html">[generators]</a>
            <a href="http://blog.sitongpeng.com/tag/len.html">[len]</a>
            <a href="http://blog.sitongpeng.com/tag/wsgi.html">[wsgi]</a>
            <a href="http://blog.sitongpeng.com/tag/content-length.html">[content-length]</a>
            <a href="http://blog.sitongpeng.com/tag/server.html">[server]</a>
            <a href="http://blog.sitongpeng.com/tag/client.html">[client]</a>
            <a href="http://blog.sitongpeng.com/tag/response.html">[response]</a>
    </p>
        </article>
        <footer>
        Awesomeness powered by <a href="http://getpelican.com/">Pelican</a> and <a href="http://jinja.pocoo.org/docs/">Jinja2</a>.
        </footer>
    </section>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37415854-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'sitong-blog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>