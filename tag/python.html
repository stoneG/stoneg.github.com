<!DOCTYPE html>
<html lang="en">
<head>
        <title>Writing - python</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
        <link href="https://stoneg.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Writing Atom Feed" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700,400italic,700italic|Droid+Sans+Mono|Merriweather:400,300,700' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/theme/css/highlight.css">

        <!--[if IE]>
                <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://stoneg.github.io/css/ie.css"/>
                <script src="https://stoneg.github.io/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="https://stoneg.github.io/css/ie6.css"/><![endif]-->

</head>

<body>

    <header id="sidebar">
        <div class="bounds">
            <a href="https://twitter.com/stoneG_" target="_blank"><img class="face" src="https://raw.github.com/stoneG/stoneg.github.com/master/images/face.jpg"></a>
            <h1><a href="/">Writing</a></h1>
            <p>My thoughts, shared</p>
                <ul>
                    <li><a href="/index.html">Home</a></li>
                    <li><a href="https:///about.html">About</a></li>
                    <li><a href="/archives.html">Archives</a></li>
                    <li><a href="/tags.html">Tags</a></li>
                    <li><a href="/feeds/all.atom.xml">Atom</a></li>
                    <li></li>
                            <li><a href="https://twitter.com/stoneG_">Twitter</a></li>
                            <li><a href="https:/github.com/stoneG">Github</a></li>
                </ul>
        </div>
    </header>

    <section id="main">

        <header>
            <h1><a href="https://stoneg.github.io/posts/the-self-aware-python-function.html" rel="bookmark"
                   title="Permalink to The Self Aware Python Function">The Self Aware Python Function</a></h1>
<p class="date">Saturday, January 18, 2014</p>        </header>
        <article>
            <p>I've been using Python for over a year now. It's what I learned to program with. About half a year ago, a fellow coder (friend of a friend) posed the following riddle upon learning that it was my language of choice:</p>
<p class="quote">"How would you write a function in Python that knows how many times it's been invoked?"</p>

<p>Let's consider this for a moment. A function that knows how many times it has been invoked is one that would need some access to a scope outside of it's own. Functions are generally pretty transient &mdash; they do their thing and then wait until they are told to do it again. There isn't a middling dormant state where they consider how many times they've been told to execute their (probably) menial task.</p>
<p>As a first stab, we might consider a global counter, as in the following setup:</p>
<div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">self_aware_function</span><span class="p">():</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;This is my first time doing this&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;I have done this {} times now.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">self_aware_function</span><span class="p">()</span>
</pre></div>


<p>Those familiar with Python are up in arms right now, and rightfully so. Here's what you get when invoking <code>self_aware_function</code>:</p>
<div class="highlight"><pre><span></span>UnboundLocalError: <span class="nb">local</span> variable <span class="s1">&#39;count&#39;</span> referenced before assignment
</pre></div>


<p>In Python, when you are in a function and assign a value to an immutable type variable (such as our int <code>count</code>), you end up shadowing the global variable with one local to the function's scope. So when <code>count += 1</code> is evaluated (remember this is expanded to <code>count = count + 1</code>), Python cannot find the value for <code>count</code> in the expression to the right of the <code>=</code>.</p>
<h2>Okay, local variables won't work, how about we use the <code>global</code> keyword or mutable variables?</h2>
<div class="highlight"><pre><span></span><span class="c1"># global keyword</span>

<span class="k">def</span> <span class="nf">self_aware_function</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">count</span> <span class="c1"># Now we force the use of the global count</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># ...</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># using a list</span>
<span class="n">count</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">self_aware_function</span><span class="p">():</span>
    <span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># ...</span>
</pre></div>


<p>These both work and globals were my first idea for a solution. However, when I asked if this was acceptable, I was met with opposition.</p>
<p class="quote">"You are only allowed to write code within the function, not outside of it."</p>

<p>That's rough. How do you become self aware of an outside world/scope that you can't even interact with?</p>
<p>Turns out, the answer lies within a popular Python <a href="https://effbot.org/zone/default-values.html">gotcha</a>.</p>
<h2>Self-awareness</h2>
<p>Here's how you define a default parameter in Python:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">default</span>
</pre></div>


<p>In Python, default parameters are evaluated ONLY once &mdash; when the function is defined. That means the default parameter is "the same" for all invocations of the function. I say "the same" because normally the default parameter will have the same value across multiple function invocations, but if your default parameter is mutable then you change it! And then you can do some really special things.</p>
<p>Case in point, self-awareness:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">self_aware_function</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;This is my first time doing this&#39;</span>
    <span class="k">elif</span> <span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;Who are you to tell me what to do???&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;I have done this {} times now.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">self_aware_function</span><span class="p">()</span>
</pre></div>


<ul>
<li><code>count</code> is evaluated at function definition to be a mutable list with one integer element.</li>
<li>Each invocation of our <code>self_aware_function</code> adds another tick to our mutable <code>count</code> parameter.</li>
</ul>
<p>And we have our cheeky, self aware function!</p>
<div class="highlight"><pre><span></span>$ python aware.py
This is my first <span class="nb">time</span> doing this
I have <span class="k">done</span> this <span class="m">2</span> <span class="nb">times</span> now.
I have <span class="k">done</span> this <span class="m">3</span> <span class="nb">times</span> now.
I have <span class="k">done</span> this <span class="m">4</span> <span class="nb">times</span> now.
I have <span class="k">done</span> this <span class="m">5</span> <span class="nb">times</span> now.
I have <span class="k">done</span> this <span class="m">6</span> <span class="nb">times</span> now.
I have <span class="k">done</span> this <span class="m">7</span> <span class="nb">times</span> now.
I have <span class="k">done</span> this <span class="m">8</span> <span class="nb">times</span> now.
I have <span class="k">done</span> this <span class="m">9</span> <span class="nb">times</span> now.
Who are you to tell me what to <span class="k">do</span>???
</pre></div>


<p><span class="note">If you're wondering, mutable default arguments was the answer I gave after a good amount of thought. I believe there are other solutions and I invite you to share them in the comments :)</span></p>
    <p class="comments">
        <a href="https://stoneg.github.io/posts/the-self-aware-python-function.html#disqus_thread"></a>.
    </p>
    <p class="tags">
            <a href="https://stoneg.github.io/tag/python.html">[python]</a>
    </p>
        </article>

        <header>
            <h1><a href="https://stoneg.github.io/posts/objects-attributes-functions-and-methods.html" rel="bookmark"
                   title="Permalink to Objects, attributes, functions, and methods">Objects, attributes, functions, and methods</a></h1>
<p class="date">Sunday, April 07, 2013</p>        </header>
        <article>
            <p>I set some time out to open the box on some <a href="https://www.python.org">Python</a> fundamentals this weekend. I have a few topics to write about but, for today, let's talk a little about objects.</p>
<h2>Objects</h2>
<p>Objects are a big deal in Python. And rightfully so, as most developers use Python in an object oriented manner, though you can certainly write imperatively or pseudo-functionally too. In fact, some people subscribe to the thought that <a href="https://www.diveintopython.net/getting_to_know_python/everything_is_an_object.html">everything in Python is an object</a>. I'm not going to argue about whether that's true or not so we'll just tip-toe around it and state that there are an <strong>awful lot of objects</strong>.</p>
<p>So what is an object? Let's use <a href="https://en.wikipedia.org/wiki/Object_(computer_science)#Properties_of_an_object">Wikipedia</a>'s definition. Objects are characterized by these properties:</p>
<h4>Identity (Objects are unique from each other)</h4>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Trivial</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">obj</span><span class="p">,</span> <span class="n">diff_obj</span> <span class="o">=</span> <span class="n">Trivial</span><span class="p">(),</span> <span class="n">Trivial</span><span class="p">()</span>

<span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="c1"># 25851216</span>
<span class="nb">id</span><span class="p">(</span><span class="n">diff_obj</span><span class="p">)</span> <span class="c1"># 26133840</span>
</pre></div>


<h4>State (Can store data in object)</h4>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># modules are objects</span>
<span class="n">os</span><span class="o">.</span><span class="n">my_data</span> <span class="o">=</span> <span class="s1">&#39;arbitrary&#39;</span>
<span class="k">print</span> <span class="n">os</span><span class="o">.</span><span class="n">my_data</span> <span class="c1"># arbitrary</span>
</pre></div>


<h4>Behavior (Can manipulate the object)</h4>
<div class="highlight"><pre><span></span><span class="k">print</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;strings&#39;</span><span class="p">,</span> <span class="s1">&#39;are&#39;</span><span class="p">,</span> <span class="s1">&#39;objects&#39;</span><span class="p">,</span> <span class="s1">&#39;with&#39;</span><span class="p">,</span> <span class="s1">&#39;methods&#39;</span><span class="p">])</span>
<span class="c1"># strings are objects with methods</span>
</pre></div>


<h2>Attributes and Methods</h2>
<p>You're probably familiar with setting object attributes to static data or writing simple methods if you've worked with objects in the past.</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Lannister</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">say_family_motto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s1">&#39;{} says: &quot;Hear Me Roar!&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="n">tyrion</span> <span class="o">=</span> <span class="n">Lannister</span><span class="p">()</span>

<span class="k">print</span> <span class="n">tyrion</span><span class="o">.</span><span class="n">name</span>
<span class="c1"># Tyrion Lannister</span>
<span class="n">tyrion</span><span class="o">.</span><span class="n">say_family_motto</span><span class="p">()</span>
<span class="c1"># Tyrion Lannister says: &quot;Hear Me Roar!&quot;</span>
</pre></div>


<p>But you're actually not limited to such trivial behavior. For instance, since functions are first class objects in Python, you could easily do the following too.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">say_common_motto</span><span class="p">():</span>
    <span class="k">print</span> <span class="s1">&#39;A Lannister Always Pays His Debts.&#39;</span>

<span class="n">tyrion</span><span class="o">.</span><span class="n">say_common_motto</span> <span class="o">=</span> <span class="n">say_common_motto</span>

<span class="n">tyrion</span><span class="o">.</span><span class="n">say_common_motto</span><span class="p">()</span>
<span class="c1"># A Lannister Always Pays His Debts.</span>
</pre></div>


<p>As you can see, we've set the <code>.say_common_motto</code> attribute to the function object <code>say_common_motto</code>, then invoked the attribute.</p>
<p>Before we continue, we should make a distinction between <code>.say_common_motto</code> and <code>.say_family_motto</code>.</p>
<div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">tyrion</span><span class="o">.</span><span class="n">say_common_motto</span><span class="p">)</span>
<span class="c1"># &lt;type &#39;function&#39;&gt;</span>
<span class="nb">type</span><span class="p">(</span><span class="n">tyrion</span><span class="o">.</span><span class="n">say_family_motto</span><span class="p">)</span>
<span class="c1"># &lt;type &#39;instancemethod&#39;&gt;</span>
</pre></div>


<p>Python resolves the type of <code>.say_common_motto</code> to a function object and <code>.say_family_motto</code> to an instance method object. What's the difference?</p>
<p>You can think of a method as a function with a unique difference. A method always takes the object it's associated with as it's first argument. You don't have a choice on the matter.</p>
<p>Under the hood, when Python sees <code>tyrion.say_family_motto()</code>, it first looks for a <code>.say_family_motto</code> attribute in <code>tyrion</code> (this means you can override an object method by writing to an object attribute with the same name). When it doesn't find that, the interpreter will jump up to the class level and look for <code>say_family_motto</code> function defined at the class level. Once found, it will invoke the function as a method - namely, by attaching the <code>tyrion</code> object to the head of the argument list. That's also why a method definition always includes a positional argument placeholder first (traditionally called <code>self</code> in Python).</p>
<p>Methods are really just a shortcut though. You can actually just define your own function with an argument placeholder for an object and attach the function to the object attribute. An example makes this clearer. Suppose we rewrote the <code>say_common_motto</code> function to make it equivalent to a method.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">say_common_motto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span> <span class="s1">&#39;{} says: &quot;A Lannister Always Pays His Debts.&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="n">tyrion</span><span class="o">.</span><span class="n">say_common_motto</span> <span class="o">=</span> <span class="n">say_common_motto</span>

<span class="n">tyrion</span><span class="o">.</span><span class="n">say_common_motto</span><span class="p">(</span><span class="n">tyrion</span><span class="p">)</span>
<span class="c1"># Tyrion Lannister says: &quot;A Lannister Always Pays His Debts.&quot;</span>

<span class="n">tyrion</span><span class="o">.</span><span class="n">say_family_motto</span><span class="p">()</span>
<span class="c1"># Tyrion Lannister says: &quot;Hear Me Roar!&quot;</span>
</pre></div>


<p>As you can see, defining a method in the class is a lot cleaner than attaching a function to the instance object. But both styles get you to the same resolution eventually. </p>
<p>Anyways, hopefully you know a little more about Python objects now.</p>
    <p class="comments">
        <a href="https://stoneg.github.io/posts/objects-attributes-functions-and-methods.html#disqus_thread"></a>.
    </p>
    <p class="tags">
            <a href="https://stoneg.github.io/tag/objects.html">[objects]</a>
            <a href="https://stoneg.github.io/tag/python.html">[python]</a>
            <a href="https://stoneg.github.io/tag/functions.html">[functions]</a>
    </p>
        </article>

        <header>
            <h1><a href="https://stoneg.github.io/posts/sustained-momentum.html" rel="bookmark"
                   title="Permalink to Sustained momentum">Sustained momentum</a></h1>
<p class="date">Wednesday, March 20, 2013</p>        </header>
        <article>
            <p>In the next couple months, I'm planning on writing more about <code>Javascript</code> as I pick it up in work and from my own reading. Towards the end of <a href="https://www.recurse.com">Hacker School</a>, I decided I wanted to explore it as my second programming language. Reasoning: I can return to my functional programming roots and I can round out my understanding of web development by getting intimate with how the browser works.</p>
<p>However, this doesn't mean I will stop developing in <code>Python</code>. Aside from <a href="https://www.djangoproject.com/">Django</a> exposure at work, I'm planning to continue building web applications for myself - and hopefully with more robust front-end UI.</p>
<p>But, that's not quite good enough. If there was one thing I took away from Hacker School, it was the idea that I should always be pushing myself to become a better programmer. Web development is fun and lets me exercise my creative side, but I want to step outside my comfort zone and pursue other avenues of technology too. I'm not entirely sure what direction I'll look but I think my best bet is to attach myself to an open source project and develop a deep understanding of that problem space.</p>
<p>Anyways, I'll think on that and come back with my decision within the next month. Hold me to it!</p>
    <p class="comments">
        <a href="https://stoneg.github.io/posts/sustained-momentum.html#disqus_thread"></a>.
    </p>
    <p class="tags">
            <a href="https://stoneg.github.io/tag/future.html">[future]</a>
            <a href="https://stoneg.github.io/tag/javascript.html">[javascript]</a>
            <a href="https://stoneg.github.io/tag/python.html">[python]</a>
            <a href="https://stoneg.github.io/tag/django.html">[django]</a>
            <a href="https://stoneg.github.io/tag/open-source.html">[open source]</a>
            <a href="https://stoneg.github.io/tag/hacker-school.html">[hacker school]</a>
    </p>
        </article>

        <header>
            <h1><a href="https://stoneg.github.io/posts/understanding-heaps.html" rel="bookmark"
                   title="Permalink to Understanding heaps">Understanding heaps</a></h1>
<p class="date">Saturday, February 02, 2013</p>        </header>
        <article>
            <p>I'm spending this weekend filling in some of the holes in my programming background, data structures in particular. As part of the learning process, I want to share my new understanding of heaps.</p>
<h2>What is it?</h2>
<p>A heap is a type of <a href="https://en.wikipedia.org/wiki/Priority_queue">priority queue</a>, which is just a queue where dequeued elements are primarily selected based on their "priority" and secondarily selected based on the "first in first out" principle. A heap prioritizes by key values of objects it stores, which leads to the two flavors of heaps: the max heap and min heap. The max heap will dequeue the objects with the highest keys first. If there are multiple maxes, the heap will dequeue by order of insertion. As you'd expect, the min heap is the same except it dequeues objects with the lowest keys first.</p>
<h2>Introducing the max heap</h2>
<p>Although a heap is technically a priority queue, and although we are going to implement it as an array, heaps are commonly represented as a binary tree. Here is the max heap we're going to work with:</p>
<p><img alt="Binary max heap" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Heap_delete_step0.svg/500px-Heap_delete_step0.svg.png"></p>
<p>There are two conditions that must be met for a binary tree to be a max heap.</p>
<ol>
<li>Every parent node must be at least as large as either child nodes. This means the max key will always be at the top of the tree.</li>
<li>The tree must be complete at all levels except the deepest. The deepest level must be populated from the left. This means if the above tree had another node, it would be the left child of the node 8.</li>
</ol>
<p>We're going to implement this heap as an array. This boils down to extracting nodes left to right, top to bottom. Here's what it will look like:</p>
<div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>


<p><span id="note">Normally heaps hold objects with the keys we are showing in the tree and array representation. For simplicity, we'll just assume the objects and keys are one and the same.</span></p>
<p>We also need to keep track of the parent and children of any given node. That's pretty natural for binary trees but how is that implemented in arrays? Turns out it's pretty simple with one-indexing, due to the way we are pulling elements off the tree.</p>
<div class="highlight"><pre><span></span>  1  2  3  4  5  &lt;-- One-indexing
[11, 5, 8, 3, 4]
                             EXAMPLE:
parent(i) = floor(i/2)            parent(2) = 1
left_child(i) = i*2           left_child(2) = 4
right_child(i) = i*2 + 1     right_child(2) = 5
</pre></div>


<p>Let's code up what we have. I prefer to have zero-indexing so the math on the parent/children calculation will have to compensate.</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MaxHeap</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="n">left</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">left</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
</pre></div>


<p>Now, a heap has two basic operations: insert and extract_max (extract_min). These are guaranteed to run in <code>O(logN)</code> time, or in other words, the height of the binary tree.</p>
<h2>Insert</h2>
<p>What does an insert look like in our binary tree model? Following the conditions of a binary heap, we have to insert the new object at the deepest level, moving in from the left. That corresponds to the node marked X below:</p>
<p><img alt="Insert at X" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/Heap_add_step1.svg/500px-Heap_add_step1.svg.png"></p>
<p>It should be pretty obvious that the object we insert could break the heap property of this tree. Whatever key we end up with, we first need to compare it with its parent node. The parent node's key is 8, so if we insert an object with <code>key &lt;= 8</code> then we wouldn't have to do anything further. But what if the key is something higher like 15? Then our insertion would break heap condition #2.</p>
<p>In this situation, the next step is to swap our inserted node with it's parent node. </p>
<p><img alt="Swap with parent" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Heap_add_step2.svg/500px-Heap_add_step2.svg.png"></p>
<p>Cool. But now when we check 15 against its new parent, the root, we notice we're still in trouble. So we swap again. These swap acts are also known as "bubbling up" or "heapifying up", as the inserted object is promoted levels due to its priority.</p>
<p><img alt="Promoted to root" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/51/Heap_add_step3.svg/500px-Heap_add_step3.svg.png"></p>
<p>Now that 15 has made it's way up to the root node, we can stop. As you can see, the new tree follows all conditions to be classified as a max heap. Here's the code for the insert operation.</p>
<div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">parent</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">parent</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">parent</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">parent</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># parent is root</span>
                <span class="k">break</span>
</pre></div>


<p>As you can see, we first insert to the end of the array, then while the inserted key is larger than its parent, we swap it upward until it finds its place.</p>
<h2>Extract Max</h2>
<p>I believe this is also known as Delete Max, but in either case, this operation removes the max from the heap. And because we're working with a heap, we know the max is the root of the tree (or first element of the array), so we certainly don't need to traverse through the entire structure to determine it.</p>
<p><img alt="Binary max heap" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Heap_delete_step0.svg/500px-Heap_delete_step0.svg.png"></p>
<p>Now, as mentioned before, the first step is to remove the root node. That leaves us with a tricky situation. What node will replace the root?</p>
<p>Let's go through our options.</p>
<ul>
<li>Pull up the 5. Well, now we fail both conditions. The root is now less than the right child, and more importantly we have an incomplete binary tree.</li>
<li>Pull up the 8. Cool, our root is the max, but now we have an entire empty branch on the right. That seems like a big problem and we can't just fix it by pulling from an entirely separate branch.</li>
<li>Pull up the 3. Breaks the complete tree again.</li>
<li>Pull up the 4. We still have a complete tree (in terms of a heap at least). We have a bad root but maybe we can shift that node back down.</li>
</ul>
<p>So the general solution seems to be, promote the last element of the tree/array.</p>
<p><img alt="Big promotion here" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ee/Heap_remove_step1.svg/500px-Heap_remove_step1.svg.png"></p>
<p>So now the new root is no longer the max. We need to swap it with one of its children. If we swap with 5, we'll still have the same problem. We'll need to swap with 8. This should lead us to the realization that we'll always want to swap with the higher of the two children, otherwise we'll just be making more of a mess of things.</p>
<p><img alt="Back to normalcy" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/22/Heap_remove_step2.svg/500px-Heap_remove_step2.svg.png"></p>
<p>Now we have our max extracted heap!</p>
<p>Here's the code:</p>
<div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">extract_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">right</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">):</span> <span class="c1"># if right exists, so does left</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">right</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">right</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">]</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">left</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">right</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">right</span><span class="p">]</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">right</span>
                <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># we have a heap again</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">]</span>
</pre></div>


<p><span id="note">I'm not actually returning the max here, but you can build that in pretty easily.</span></p>
<p><code>extract_max</code> is a bit more complicated than <code>insert</code>. Swapping the new root down takes a few more comparision steps as we have to decide which child to swap with. We're still within <code>O(logN)</code> time though, since we will never need to swap more than the height of the binary tree.</p>
<h2>So what are heaps good for?</h2>
<p>In general, when you constantly need to access the min or max of some data, heaps are a logical choice, as you just need to pluck it from the top of the tree/front of the array and do a little rearranging. This means they are useful for tasks like managing bandwith on a router (always send the prioritized traffic first) or handling asynchronous event processing (firing off shortest tasks first).</p>
<p>Heaps are also useful in speeding up certain algorithms that require multiple min or max computations. One example is Dijkstra's shortest path algorithm, where you are constantly computing the minimum path for each node.</p>
<p>So, hopefully you've now got a solid understanding of heaps. Next time you're working on something and you find yourself repeatedly taking minimums or maximums, you should give them a try. They will make your life easier.</p>
    <p class="comments">
        <a href="https://stoneg.github.io/posts/understanding-heaps.html#disqus_thread"></a>.
    </p>
    <p class="tags">
            <a href="https://stoneg.github.io/tag/heaps.html">[heaps]</a>
            <a href="https://stoneg.github.io/tag/data-structures.html">[data structures]</a>
            <a href="https://stoneg.github.io/tag/python.html">[python]</a>
    </p>
        </article>

        <header>
            <h1><a href="https://stoneg.github.io/posts/bit-manipulation-fun.html" rel="bookmark"
                   title="Permalink to Bit manipulation fun">Bit manipulation fun</a></h1>
<p class="date">Wednesday, January 30, 2013</p>        </header>
        <article>
            <p>So while I was working on interview prep, I got a bit curious about what cool ways bit manipulation might alter the way we might write code. Here's a few examples of short functions you can write using only bit operations.</p>
<h2>Simple stuff first</h2>
<p>The following trick may be standard fare but seeing as I am not a "classically" trained programmer (no degree in computer science), this guy did tickle my fancy.</p>
<p>When you write out a integer in a binary representation, 5 as <code>0101</code> for example, the least significant bit (leftmost bit) represents if the integer is odd or even. Of course, bits further left represent powers of two, hence the term "base two".</p>
<div class="highlight"><pre><span></span>0101 is 0*(2^3) + 1*(2^2) + 0*(2^1) + 1*(2^0)
     or 0*8 + 1*4 + 0*2 + 1*1
     or 5
</pre></div>


<p>Anyone can write a simple function that tests if a given integer <code>x</code> is even. Usually it will involve checking to see if <code>x</code> mod 2 is 0.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>


<p>But, given that least significant bit of a binary value represents odd or even, we can write that same <code>is_even</code> function using the <code>AND</code> bit operation. </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>


<p>For example 6 &amp; 1 is 0.</p>
<div class="highlight"><pre><span></span>  0110  &lt;-- 6
&amp; 0001  &lt;-- 1
======
  0000
</pre></div>


<p>This ends up being the same amount of typing but it's interesting that we have this second option of writing the <code>is_even</code> function.</p>
<h2>Powerful twos</h2>
<p>If you work on <a href="https://projecteuler.net/">Project Euler</a> problems frequently, the following shortcut might be beneficial to keep in mind. Here's a function that checks if <code>x</code> is a power of two.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_power_of_two</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">power_of_two</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span> <span class="n">power_of_two</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">power_of_two</span> <span class="o">*=</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">power_of_two</span> <span class="o">==</span> <span class="n">x</span>
</pre></div>


<p>That's pretty compact but it turns out binary is well suited to figure out if a number is a power of two.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_power_of_two</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>


<p>Let's see this in action with <code>x</code> as some random binary number:</p>
<div class="highlight"><pre><span></span>  010110000  &lt;-- x
- 000000001
===========
  010101111  &lt;-- x-1
&amp; 010110000
===========
  010100000  &lt;-- x &amp; (x-1)

So, (x &amp; (x-1)) just removed the left-most bit that was equal to 1. But then, when might (x &amp; (x-1)) be 0? That would only happen when x has only one 1 bit, which means that x must be a power of 2.
</pre></div>


<h2>Swapping in place</h2>
<p>Python is nice in that you never have to use a temporary variable when you want to do variable swaps. This is, of course, not the same in other languages.</p>
<div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span>
</pre></div>


<p>Behind the scenes, Python accesses the values of <code>y</code> and <code>x</code>, then rotates them as it unpacks and assigns to <code>x</code> and <code>y</code>. Here's what that looks like when run through the Python disassembler:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dis</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

<span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="o">&gt;</span>
<span class="o">&gt;</span>  <span class="mi">3</span>           <span class="mi">0</span> <span class="n">LOAD_CONST</span>               <span class="mi">1</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;</span>              <span class="mi">3</span> <span class="n">STORE_FAST</span>               <span class="mi">0</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;</span>
<span class="o">&gt;</span>  <span class="mi">4</span>           <span class="mi">6</span> <span class="n">LOAD_CONST</span>               <span class="mi">2</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;</span>              <span class="mi">9</span> <span class="n">STORE_FAST</span>               <span class="mi">1</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;</span>
<span class="o">&gt;</span>  <span class="mi">5</span>          <span class="mi">12</span> <span class="n">LOAD_FAST</span>                <span class="mi">0</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;</span>             <span class="mi">15</span> <span class="n">LOAD_FAST</span>                <span class="mi">1</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;</span>             <span class="mi">18</span> <span class="n">ROT_TWO</span>             
<span class="o">&gt;</span>             <span class="mi">19</span> <span class="n">STORE_FAST</span>               <span class="mi">0</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;</span>             <span class="mi">22</span> <span class="n">STORE_FAST</span>               <span class="mi">1</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;</span>
<span class="o">&gt;</span>  <span class="mi">6</span>          <span class="mi">25</span> <span class="n">LOAD_FAST</span>                <span class="mi">1</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;</span>             <span class="mi">28</span> <span class="n">LOAD_FAST</span>                <span class="mi">0</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;</span>             <span class="mi">31</span> <span class="n">ROT_TWO</span>             
<span class="o">&gt;</span>             <span class="mi">32</span> <span class="n">STORE_FAST</span>               <span class="mi">0</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;</span>             <span class="mi">35</span> <span class="n">STORE_FAST</span>               <span class="mi">1</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="o">&gt;</span>             <span class="mi">38</span> <span class="n">LOAD_CONST</span>               <span class="mi">0</span> <span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="o">&gt;</span>             <span class="mi">41</span> <span class="n">RETURN_VALUE</span> 
</pre></div>


<p>But, did you know we can actually swap without a temporary variable using <code>XOR</code> too.</p>
<div class="highlight"><pre><span></span>x ^= y
y ^= x
x ^= y
</pre></div>


<p>To understand what's happening, you should recall that <code>XOR</code> is commutative, <code>x^x</code> is 0, and <code>x^0</code> is <code>x</code>. Let's break down the <a href="https://en.wikipedia.org/wiki/XOR_swap_algorithm">XOR Swap Algorithm</a> again.</p>
<div class="highlight"><pre><span></span><span class="gh">start   -&gt;  breaking down  -&gt;  commuting      -&gt;  cancelling -&gt;  removing 0&#39;s</span>
<span class="gh">=============================================================================</span>
x ^= y  -&gt;  x = x^y
y ^= x  -&gt;  y = y^x^y      -&gt;  y = x^y^y      -&gt;  y = x^0    -&gt;  y = x
x ^= y  -&gt;  x = x^y^y^x^y  -&gt;  x = x^x^y^y^y  -&gt;  x = 0^y^0  -&gt;  x = y
</pre></div>


<p>That's pretty cool but I'll stick to Python's easy swap. It is nice, however, to see how binary manipulation can be used to our advantage in languages that don't have an in-place swap.</p>
<p>Now for the disclaimer. While the XOR swap is pretty nifty, it doesn't have much practical use. If you actually plan on using it in the real world, hopefully your application fits in one of <a href="https://en.wikipedia.org/wiki/XOR_swap_algorithm#Reasons_for_use_in_practice">these</a> buckets. Turns out, optimizing compilers tend to make temporary variable swaps pretty efficient, often faster than this XOR swap.</p>
<p><span id="note">Have any more bit manipulation tricks you'd like to share? Leave me a comment, I'd love to see more in action.</span></p>
    <p class="comments">
        <a href="https://stoneg.github.io/posts/bit-manipulation-fun.html#disqus_thread"></a>.
    </p>
    <p class="tags">
            <a href="https://stoneg.github.io/tag/bit-manipulation.html">[bit manipulation]</a>
            <a href="https://stoneg.github.io/tag/binary.html">[binary]</a>
            <a href="https://stoneg.github.io/tag/tricks.html">[tricks]</a>
            <a href="https://stoneg.github.io/tag/python.html">[python]</a>
            <a href="https://stoneg.github.io/tag/algorithms.html">[algorithms]</a>
    </p>
        </article>
<p class="paginator">
    Page 1 / 2
        <a href="https://stoneg.github.io/tag/python2.html">&gt;&gt;</a>
</p>
        <footer>
        Awesomeness powered by <a href="https://getpelican.com/">Pelican</a> and <a href="https://jinja.pocoo.org/docs/">Jinja2</a>.
        </footer>
    </section>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37415854-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'sitong-blog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>