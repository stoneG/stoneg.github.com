<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>On generators and len</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="A Pelican Blog Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">A Pelican Blog </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/2012.html">2012</a></li>
                    <li><a href="/category/2013.html">2013</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/on-generators-and-len.html" rel="bookmark"
           title="Permalink to On generators and len">On generators and len</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-12-05T18:21:00">
                Wed 05 December 2012
        </abbr>

<p>In <a href="/category/2012.html">2012</a>. </p>
<p>tags: <a href="/tag/whiskey.html">whiskey</a><a href="/tag/python.html">python</a><a href="/tag/http.html">http</a><a href="/tag/generators.html">generators</a><a href="/tag/len.html">len</a><a href="/tag/wsgi.html">wsgi</a><a href="/tag/content-length.html">content-length</a><a href="/tag/server.html">server</a><a href="/tag/client.html">client</a><a href="/tag/response.html">response</a></p>
</footer><!-- /.post-info -->      <p>So one of the WSGI server specifications is that if a WSGI application
doesn’t supply the Content-Length response header, it is the job of the
WSGI server to try to determine the Content-Length of the response body
(if possible). This is straightforward enough for the average WSGI app,
which will return the response body in a list object. However, WSGI apps
also have the option of using a generator to return the response body
(since the specification only requires that the app return is an
iterable).</p>
<div class="section" id="so-can-we-apply-the-len-function-to-the-output-of-a-generator">
<h2>So can we apply the len function to the output of a generator?</h2>
</p><p>The answer is no. Generators are simple constructs that just yield
values when you iterate on them, immediately passing output along. And
since generators keep no memory of past generated values, they have no
idea what the length of their output is or will be. Therefore they don’t
have a len attribute.</p>
</div>
<div class="section" id="so-how-do-we-send-the-client-the-content-length-if-the-app-is-a-generator">
<h2>So how do we send the client the Content-Length if the app is a generator?</h2>
</p><p>Well, in HTTP/1.1, some servers and clients support the chunked transfer
coding. This allows servers to send response bodies in chunks, as they
are available. Each chunk will have it’s own Content-Length. I hope to
support chunked transferring in <a class="reference external" href="https://github.com/stoneG/whiskey">whiskey</a>, so I can always provide a
Content-Length. I’ll be sure to post about my implementation.</p>
</div>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>